/*! test 2014-05-20 15:46:54 */
function imgReadyObj(a,b,c,d){this.arrfn=[],this.intervalId=null,this.url=a,this.ready=b,this.load=c,this.error=d,this.inte()}!function(a){a.fn.imgloaded=function(b){return b=a.extend({srcAttr:"",errorSrc:"http://you.ctrip.com/newimg/nophoto.jpg",width:"",height:""},b),this.each(function(){var c=a(this).attr(b.srcAttr||"realSrc")||"",d=this;c&&new imgReadyObj(c,function(){var a=this.width/this.height;a>=b.width/b.height?(d.height=b.height,d.width=b.height*a):(d.width=b.width,d.height=b.width/a),"function"==typeof b.readyCallback&&setTimeout(function(){b.readyCallback.call(d)},10)},function(){d.src=c,"function"==typeof b.loadCallback&&setTimeout(function(){b.loadCallback.call(d)},10)},function(){d.src=b.errorSrc,"function"==typeof b.errorCallback&&b.errorCallback.call(d)})})}}(jQuery),imgReadyObj.prototype={exec:function(){this.arrfn[0].end?this.arrfn.length=0:this.arrfn[0](),!this.arrfn.length&&this.stop()},stop:function(){clearInterval(this.intervalId),this.intervalId=null},inte:function(){var a,b,c,d,e,f=new Image,g=this;return f.src=this.url,f.complete?(this.ready.call(f),void(this.load&&this.load.call(f))):(b=f.width,c=f.height,f.onerror=function(){g.error&&g.error.call(f),a.end=!0,f=f.onload=f.onerror=null},a=function(){d=f.width,e=f.height,(d!==b||e!==c||d*e>1024)&&(g.ready.call(f),a.end=!0)},f.onload=function(){!a.end&&a(),g.load&&g.load.call(f),f=f.onload=f.onerror=null},f.src=this.url,void(a.end||(g.arrfn.push(a),null===this.intervalId&&(this.intervalId=setInterval(function(){g.exec.apply(g)},40)))))}};